<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechEdge Portfolio</title>
    <link rel="stylesheet" href="style.css">


    <style>
        /* Styling the comment section */
        #comments {
            margin-top: 40px;
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
        }

        #comments h2 {
            font-size: 24px;
            color: #580c1f;
            margin-bottom: 20px;
        }

        /* Comment item card style */
        .comment {
            background-color: #ffffff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease;
            text-align: justify;
        }

        .comment:hover {
            background-color: #f4f4f4;
        }

        .comment p {
            margin: 8px 0;
            font-size: 14px;
            color: #333;
        }

        .comment-text {
            font-size: 26px !important;
        }

        .comment .username {
            font-weight: bold;
            color: #580c1f;
        }

        .comment .timestamp {
            font-size: 12px;
            color: #888;
        }

        .comment .edit-btn {
            background-color: #580c1f;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }

        .comment .edit-btn:hover {
            background-color: #333;
        }

        /* Styling the comment form */
        #commentForm {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        textarea {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-size: 14px;
            color: #333;
            resize: vertical;
            box-sizing: border-box;
        }

        button {
            background-color: #580c1f;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #333;
        }

        /* Modal Styling */
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 500px;
            border-radius: 10px;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
        }

        .modal-content h2 {
            font-size: 22px;
            color: #580c1f;
        }

        .modal-content textarea {
            width: 100%;
            height: 150px;
            padding: 10px;
            font-size: 14px;
            border: 1px solid #ddd;
            border-radius: 5px;
            color: #333;
            resize: none;
        }

        .close-btn {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            float: right;
        }

        .close-btn:hover,
        .close-btn:focus {
            color: black;
            cursor: pointer;
        }
    </style>

</head>

<body>
    <!-- Header Section -->
    <header>
        <div class="logo">
            <img src="./images/Logo.png" alt="TechEdge Portfolio Logo">
        </div>
        <div class="title">
            <h1>TechEdge Portfolio</h1>
            <p>Your insight into my IT journey</p>
        </div>
        <nav>
            <ul id="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="skills.html">Skills</a></li>
                <li><a href="project.html">Project</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li id="loginSignup">
                    <a href="login.html" id="loginLink">Login</a>
                    <a href="#" id="logoutLink" style="display:none;">Logout</a>
                </li>
            </ul>
        </nav>
    </header>


    <main>
        <section id="project" class="section">
            <div class="container">
                <h1 class="main-heading" style="color:#580c1f">My Projects</h1>

                <!-- Project List -->
                <div class="project-item">
                    <div class="text">
                        <h3>International Web Association (IWA)</h3>
                        <p><strong>Role:</strong> Member</p>
                        <p><strong>Duration: </strong> 2024 - present</p>
                        <p><strong>Description: </strong> is dedicated to providing opportunities for web professionals
                            to enhance their skills and advance their careers through certifications, networking events,
                            and professional development resources.</p>
                    </div>
                    <div class="image">
                        <img src="./images/IWA Certificate.png" alt="Logo of Professional Organization" width="200"
                            height="150">
                    </div>
                </div>

                <div class="project-item">
                    <div class="image">
                        <img src="./images/NMIT Certificate.png" alt="Logo of Educational Organization" width="200"
                            height="150">
                    </div>
                    <div class="text">
                        <h3>NMIT University</h3>
                        <p><strong>Role:</strong> Student</p>
                        <p><strong>Duration: </strong> 2024 - April 2027</p>
                        <p><strong>Description: </strong> University offers a comprehensive IT program that provides
                            hands-on experience and a strong theoretical foundation. The university is known for its
                            focus on innovation and technology, preparing students for successful careers in the tech
                            industry.</p>
                    </div>
                </div>

                <div class="project-item">
                    <div class="text">
                        <h3>Certified Web Developer</h3>
                        <p><strong>Issuing Organization:</strong> International Web Association (IWA)</p>
                        <p><strong>Date Earned: </strong>May 2023</p>
                        <p><strong>Description: </strong> certification demonstrates proficiency in web development,
                            including skills in HTML, CSS, JavaScript, and PHP. It signifies a commitment to maintaining
                            up-to-date knowledge and best practices in the field.</p>
                    </div>
                    <div class="image">
                        <img src="./images/Certificate.png" alt="Logo of Certification" width="200" height="150">
                    </div>
                </div>
                <br>
                <hr><br>
                <!-- Comment Section -->
                <section id="comments">
                    <h2>Comments</h2>
                    <div id="commentsList"></div>

                    <!-- Comment Form for Logged-in Users -->
                    <form id="commentForm">
                        <textarea id="commentText" placeholder="Add a comment..." required></textarea>
                        <button type="submit">Post Comment</button>
                    </form>
                </section>

            </div>
        </section>
    </main>

    <!-- Modal for Editing Comments -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <span id="closeModal" class="close-btn">&times;</span>
            <h2>Edit Comment</h2>
            <textarea id="editCommentText"></textarea>
            <button id="saveEdit">Save</button>
        </div>
    </div>

    <footer>
        <div class="social-media">
            <a
                href="https://www.facebook.com/checkpoint/1501092823525282/?next=https%3A2F%2Fwww.facebook.com%2F">Facebook</a>
            <a href="https://www.linkedin.com/onboarding/start/follow-recommendations/new/">LinkedIn</a>
            <a href="https://www.instagram.com/meet_patel_7984/">Instagram</a>
            <a href="https://m.me/100083406470306?hash=AbYFRswqHZXOcn31&source=qr_link_share">Messenger</a>
        </div>
        <p>&copy; 2024 Meet Patel. All Rights Reserved<br><br><a href="skills-management.html">Manage Skills</a></p>
    </footer>

    <script type="module">
        import { auth, db } from './firebaseConfig.js';
        import { addDoc, collection, getDocs, query, orderBy, onSnapshot, updateDoc, doc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";
        import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";  // Import onAuthStateChanged

        const commentForm = document.getElementById("commentForm");
        const commentText = document.getElementById("commentText");
        const commentsList = document.getElementById("commentsList");
        const editModal = document.getElementById("editModal");
        const closeModal = document.getElementById("closeModal");
        const editCommentText = document.getElementById("editCommentText");
        const saveEditButton = document.getElementById("saveEdit");

        const commentsCollection = collection(db, "comments");

        let editingCommentId = null;

        // Display comments in real-time
        onSnapshot(query(commentsCollection, orderBy("timestamp", "desc")), (snapshot) => {
            commentsList.innerHTML = "";
            snapshot.forEach(doc => {
                const commentData = doc.data();
                const commentDiv = document.createElement("div");
                commentDiv.classList.add("comment");
                commentDiv.innerHTML = `
            <p class="comment-text">${commentData.text}</p>
            <p class="username">${commentData.username}</p>
            <p class="timestamp">${new Date(commentData.timestamp.seconds * 1000).toLocaleString()}</p>
            ${auth.currentUser && commentData.userId === auth.currentUser.uid ? `
                <button class="edit-btn" data-id="${doc.id}">Edit</button>
            ` : ''}
        `;
                commentsList.appendChild(commentDiv);

                // Add event listener for edit buttons
                const editButton = commentDiv.querySelector('.edit-btn');
                if (editButton) {
                    editButton.addEventListener("click", () => {
                        editingCommentId = doc.id;
                        editCommentText.value = commentData.text;
                        editModal.style.display = "block";
                    });
                }
            });
        });


        // Post a new comment
        commentForm.addEventListener("submit", async (e) => {
            e.preventDefault();

            if (!auth.currentUser) {
                alert("You need to log in to add a comment.");
                window.location.href = "login.html";
                return;
            }

            try {
                await addDoc(commentsCollection, {
                    username: auth.currentUser.email,
                    text: commentText.value,
                    timestamp: new Date(),
                    userId: auth.currentUser.uid
                });
                commentText.value = "";
            } catch (error) {
                console.error("Error adding comment: ", error);
            }
        });

        // Save edited comment
        saveEditButton.addEventListener("click", async () => {
            if (!editingCommentId) return;

            const commentRef = doc(db, "comments", editingCommentId);

            try {
                await updateDoc(commentRef, {
                    text: editCommentText.value
                });
                editModal.style.display = "none";
                editingCommentId = null;
            } catch (error) {
                console.error("Error updating comment: ", error);
            }
        });

        // Close modal
        closeModal.addEventListener("click", () => {
            editModal.style.display = "none";
            editingCommentId = null;
        });

        // Close modal if clicked outside the content area
        window.addEventListener("click", (event) => {
            if (event.target === editModal) {
                editModal.style.display = "none";
                editingCommentId = null;
            }
        });

        // Listen for changes in the auth state
        onAuthStateChanged(auth, (user) => {
            const loginLink = document.getElementById("loginLink");
            const logoutLink = document.getElementById("logoutLink");

            if (user) {
                loginLink.style.display = "none";
                logoutLink.style.display = "inline";
            } else {
                loginLink.style.display = "inline";
                logoutLink.style.display = "none";
            }
        });

        // Add logout functionality
        document.getElementById("logoutLink").addEventListener("click", async (e) => {
            e.preventDefault();
            try {
                await signOut(auth);
                alert("You have logged out.");
                window.location.href = "index.html";  // Redirect to homepage after logout
            } catch (error) {
                console.error("Error logging out:", error);
            }
        });
    </script>


</body>

</html>